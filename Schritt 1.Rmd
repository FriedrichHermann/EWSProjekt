---
title: "1 Schritt"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

1 Schritt: Korrelationen zwischen kardiovasculären Erkrankungen und dem kardiovasculären Wohlbefinden. 

Wir führen ein:

BMI (Body-Mass-Index): ist definiert als BMI = (weight)/(height)^2 

"guter Blutdruck" : ap_hi <= 139 und ap_lo <= 89
"schlechter Blutdruck": ap_hi >= 140 oder ap_lo >= 90 dabei basieren wir uns auf der schweizerischen Herzstiftung.


```{r}
library(tidyverse)
library(patchwork)
library(gridExtra)
```






```{r}

library('tidyverse')
df_1 <-read.csv("cardio_train.csv", sep=";")
df_1$age <- df_1$age/365
df_1$height <- df_1$height/100
df_1 <- cbind(df_1 , "BMI" = (df_1$weight)/(df_1$height)^2 ) #hier habe ich den BMI eingefügt 

df_1 <- filter(df_1, ap_lo < 250,ap_lo > 20, ap_hi < 250,ap_hi > 20, BMI < 100) #hier habe ich die Patienten rausgefiltert, die für die Analyse entweder zu hohe/zu niedrige Blutdruckwerte haben

p <- ggplot(df_1, aes(x = ap_lo , y = ap_hi )) + geom_point(aes(color = ifelse(cardio == 0 , 'green' ,'red'))) + scale_colour_manual(labels = c("0","1"), values = c('green','red')) +
 labs(color = "Krankheit")

p + geom_segment(aes(x = 20, y = 139 , xend = 89 ,yend = 139)) + geom_segment(aes(x = 89, y = 20 , xend = 89 ,yend = 139)) + geom_segment(aes(x = 20, y = 20 , xend = 89 ,yend = 20)) + geom_segment(aes(x = 20, y = 20 , xend = 20 ,yend = 139)) + labs(title = "Blutdruck-Profil der Patienten") #hier habe ich zwei Segmente im Plot eingezeichnet, um die Gruppe mit niedrigem Blutdruck von der Gruppe mit hohem Blutdruck im zu unterscheiden. 



```

Innerhalb des Quadrats befindet sich die Gruppe an Patienten, die gute Blutdruckwerte haben (siehe Definition) und außerhalb des Quadrats solche, die schlechte Blutdruckwerte haben.


Am Plot erkennt man, dass sich im Quadrat mehr grüne als rote, und außerhalb deutlich mehr rote als grüne befinden. 

das muss ich noch Ergänzen
```{r}

p <- ggplot(df_1, aes(cardio,BMI)) + geom_boxplot(aes(color = ifelse(cardio == 0 , 'green' ,'red'))) + scale_colour_manual(labels = c("0","1"), values = c('green','red')) + labs(color = 'Krankheit', title = 'BMI-Profil der Patienten') + theme( aspect.ratio = 1.5) 
p 

```
```{r}

df_krank <- filter(df_1 , cardio == 1)
df_gesund <- filter(df_1 ,cardio == 0)

summary(df_gesund$BMI)
```
```{r}
summary(df_krank$BMI)
```

Man sieht anhand des Plot und der Tabellen, dass die kranken Patienten einen leicht höheren BMI vorweisen, als die gesunden. Entsprechend 26.483 und 28.473 im Mittel. Ab einem BMI von 

```{r}
gesunde <- filter(df_1, cardio == 0)
kranke <- filter(df_1, cardio == 1) 
```

Zuerst die Cholesterolwerte:
```{r}
#Plot der Cholwerte der gesunden Patienten:
t1c <- table(gesunde$cholesterol)
t1c <- (t1c/sum(t1c))*100

prozent <- round(t1c)
cholwerte <- c("gute Cholesterolwerte" , "mittelgute Cholesterolwerte" , "schlechte Cholesterolwerte")

beschriftung <- paste(cholwerte,prozent, "%", sep = " ")
p1c <- pie(t1c, main = "Cholesterolwerte der gesunden Patienten",labels = beschriftung , col = c("green" , "orange" , "red"))

#Plot der Cholwerte der kranken Patienten:

t2c <- table(kranke$cholesterol)
t2c <- (t2c/sum(t2c))*100

prozent <- round(t2c)
cholwerte <- c("gute Cholesterolwerte" , "mittelgute Cholesterolwerte" , "schlechte Cholesterolwerte")

beschriftung <- paste(cholwerte,prozent, "%", sep = " ")
p2c <- pie(t2c, labels = beschriftung ,main = "Cholesterolwerte der kranken Patienten", col = c("green" , "orange" , "red"))

#Plots zusammenfügen (nebeneinander):

grid.arrange(p1c ,p2c)
```
Nun die Glucosewerte:
```{r}
#die gesunden Patienten:

t1g <- table(gesunde$gluc)
t1g <- (t1g/sum(t1g))*100

prozent <- round(t1g)
glucwerte <- c("gute Glucosewerte" , "mittelgute Glucosewerte" , "schlechte Glucosewerte")

beschriftung <- paste(glucwerte,prozent, "%", sep = " ")
p1c <- pie(t1g, main = "Glucosewerte der gesunden Patienten",labels = beschriftung , col = c("green" , "orange" , "red"))

#die kranken Patienten:

t2g <- table(kranke$gluc)
t2g <- (t2g/sum(t2g))*100

prozent <- round(t2g)
glucwerte <- c("gute Glucosewerte" , "mittelgute Glucosewerte" , "schlechte Glucosewerte")

beschriftung <- paste(glucwerte,prozent, "%", sep = " ")
p2g <- pie(t2g, main = "Glucosewerte der kranken Patienten",labels = beschriftung , col = c("green" , "orange" , "red"))

#Plots zusammenfügen:

p1g + p2g

```





