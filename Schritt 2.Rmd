---
title: "Schritt 2"
output: html_document
---
```{r}
library(dplyr)
library(ggplot2)
library(gridExtra)
```

```{r}
df_1 <-read.csv("cardio_train.csv", sep=";")
df_1$age <- df_1$age/365
df_1$height <- df_1$height/100
df_1 <- cbind(df_1 , "BMI" = (df_1$weight)/(df_1$height)^2 )
head(df_1)
nrow(df_1)
```

Schritt 2 - Untersuchen der Gruppierungen



Gruppe 1 (Gute Gesundheit) 
- BMI 18 bis 25
ap_lo <80
ap_hi <130


Gruppe 2 (Übergewicht/ Untergewicht und Bluthochdruck):
- BMI >25
- BMI <18
- ap_lo >80
- ap_hi >130

```{r}
df_gut<-df_1 %>% filter(BMI >= 18) %>% filter(BMI <= 25) %>% filter(ap_lo<=89) %>%filter(ap_hi<=139)
df_schlecht_1<-df_1 %>% filter(BMI < 18, ap_lo > 89, ap_hi > 139)
df_schlecht_2<-df_1 %>% filter(BMI > 25, ap_lo > 89, ap_hi > 139)
df_schlecht <- rbind(df_schlecht_1,df_schlecht_2)
nrow(df_schlecht)
nrow(df_gut)

```

!! fast 4000 weniger Datenpunkte. Evtl macht es hier also sinn die Blutdruck werte aussenvor zu lassen?
TB Discussed

- Cholesterol und Glucose nicht weiter da das "Essensangewohnheiten"



Schritt 2: Untersuchen der einzelnen Gruppen und aufzeigen verschiedener Korrelationen innerhalb der Gruppe

Kategorie 1: Ernährung
- Betrachtete Variablen:
1. Cholesterol
2. Glucose

```{r}
#Glucose gesund
df_gluc1 <- data.frame(c(1,2,3),c(nrow(filter(df_gut,gluc == 1))/nrow(df_gut),nrow(filter(df_gut,gluc == 2))/nrow(df_gut),nrow(filter(df_gut,gluc == 3))/nrow(df_gut)))
colnames(df_gluc1) <- c("Glucose","Ratio")

#Cholesterol gesund
df_chol1 <- data.frame(c(1,2,3),c(nrow(filter(df_gut,cholesterol == 1))/nrow(df_gut),nrow(filter(df_gut,cholesterol == 2))/nrow(df_gut),nrow(filter(df_gut,cholesterol == 3))/nrow(df_gut)))
colnames(df_chol1) <- c("Cholesterol","Ratio")

#Glucose ungesund
df_gluc2 <- data.frame(c(1,2,3),c(nrow(filter(df_schlecht,gluc == 1))/nrow(df_schlecht),nrow(filter(df_schlecht,gluc == 2))/nrow(df_schlecht),nrow(filter(df_schlecht,gluc == 3))/nrow(df_schlecht)))
colnames(df_gluc2) <- c("Glucose","Ratio")

#Cholesterol ungesund
df_chol2 <- data.frame(c(1,2,3),c(nrow(filter(df_schlecht,cholesterol == 1))/nrow(df_schlecht),nrow(filter(df_schlecht,cholesterol == 2))/nrow(df_schlecht),nrow(filter(df_schlecht,cholesterol == 3))/nrow(df_schlecht)))
colnames(df_chol2) <- c("Cholesterol","Ratio")




plt1<-ggplot(df_gluc1, aes(x=Glucose, y=Ratio))  + geom_bar(stat = "identity") + ggtitle("Glucose Level bei guter Gesundheit")
plt2<-ggplot(df_chol1, aes(x=Cholesterol, y=Ratio))  + geom_bar(stat = "identity") + ggtitle("Cholesterol Level bei guter Gesundheit")
plt3<-ggplot(df_gluc2, aes(x=Glucose, y=Ratio))  + geom_bar(stat = "identity") + ggtitle("Glucose Level bei schlechter Gesundheit")
plt4<-ggplot(df_chol2, aes(x=Cholesterol, y=Ratio))  + geom_bar(stat = "identity") + ggtitle("Cholesterol Level bei schlechter Gesundheit")
grid.arrange(plt1,plt2,plt3,plt4, ncol=2)
```
Kategorie 2: Drogenkonsum
- Betrachtete Variablen:
1. alco
2. smoke

```{r}
#Alkohol gesund
df_alc1 <- data.frame(c(0,1),c(nrow(filter(df_gut,alco == 0))/nrow(df_gut),nrow(filter(df_gut,alco == 1))/nrow(df_gut)))
colnames(df_alc1) <- c("Alkohol","Ratio")

#Rauchen gesund
df_smoke1 <- data.frame(c(0,1),c(nrow(filter(df_gut,smoke == 0))/nrow(df_gut),nrow(filter(df_gut,smoke == 1))/nrow(df_gut)))
colnames(df_smoke1) <- c("Rauchen","Ratio")

#Alkohol ungesund
df_alc2 <- data.frame(c(0,1),c(nrow(filter(df_schlecht,alco == 0))/nrow(df_schlecht),nrow(filter(df_schlecht,alco == 1))/nrow(df_schlecht)))
colnames(df_alc2) <- c("Alkohol","Ratio")

#Rauchen ungesund
df_smoke2 <- data.frame(c(0,1),c(nrow(filter(df_schlecht,smoke == 0))/nrow(df_schlecht),nrow(filter(df_schlecht,smoke == 1))/nrow(df_schlecht)))
colnames(df_smoke2) <- c("Rauchen","Ratio")




plt5<-ggplot(df_alc1, aes(x=Alkohol, y=Ratio))  + geom_bar(stat = "identity") + ggtitle("Alkoholkonsumenten bei guter Gesundheit")
plt6<-ggplot(df_smoke1, aes(x=Rauchen, y=Ratio))  + geom_bar(stat = "identity") + ggtitle("Raucher bei guter Gesundheit")
plt7<-ggplot(df_alc2, aes(x=Alkohol, y=Ratio))  + geom_bar(stat = "identity") + ggtitle("Alkoholkonsumenten bei schlechter Gesundheit")
plt8<-ggplot(df_smoke2, aes(x=Rauchen, y=Ratio))  + geom_bar(stat = "identity") + ggtitle("Raucher bei schlechter Gesundheit")
grid.arrange(plt5,plt6,plt7,plt8, ncol=2)
```
Kategorie 3: Sportliche Betätigung
- Betrachtete Variablen:
1. active

```{r}
#Sport gesund
df_act1 <- data.frame(c(0,1),c(nrow(filter(df_gut,active == 0))/nrow(df_gut),nrow(filter(df_gut,active == 1))/nrow(df_gut)))
colnames(df_act1) <- c("Sport","Ratio")

#Sport ungesund
df_act2 <- data.frame(c(0,1),c(nrow(filter(df_schlecht,active == 0))/nrow(df_schlecht),nrow(filter(df_schlecht,active == 1))/nrow(df_schlecht)))
colnames(df_act2) <- c("Sport","Ratio")


plt9<-ggplot(df_act1, aes(x=Sport, y=Ratio))  + geom_bar(stat = "identity") + ggtitle("Körperliche Betätigung bei guter Gesundheit")

plt10<-ggplot(df_act2, aes(x=Sport, y=Ratio))  + geom_bar(stat = "identity") + ggtitle("Körperliche Betätigung bei schlechter Gesundheit")

grid.arrange(plt9,plt10, ncol=2)
```

